""""""""""""""""""""
" General Settings
""""""""""""""""""""
set incsearch true
set smoothscroll true
set tabopencontaineraware true
set containerindicator true
set visualenterauto false
set completions.Tab.statusstylepretty true

" Sane hinting mode
" Type more characters to filter hints
set hintfiltermode vimperator-reflow

" Select hints by numeric chars
" Left to right priority
set hintchars 7890654321

" Never steal keyboard focus
set allowautofocus false

" Words are separated by 1 or more whitespace
set wordpattern [^\s\/]+

" Edit with nvim
" TODO: Build minimal config from nixcats
" NOTE: Using Firenvim now instead
" set editorcmd wezterm --always-new-process --class tridactyl_editor -- nvim
" set editorcmd foot --app-id=tridactyl_editor redvim

" Autocmds
" Disable the mouse globally
" autocmd DocLoad .* no_mouse_mode

" Turn mouse mode on back on for Youtube
" autocmd DocLoad ^http(s?)://www.youtu((\.be)|(be\.com)) mouse_mode

" Disable on mcgeedia
blacklistadd ^http(s?)://cockpit.mcgee.network
blacklistadd ^http(s?)://media.mcgee.network
blacklistadd ^http(s?)://services.mcgee.network

" UI
" guiset gui none
colorscheme --url https://raw.githubusercontent.com/tridactyl/base16-tridactyl/master/base16-summerfruit-dark.css base16-summerfruit-dark
set theme base16-summerfruit-dark

""""""""""""""""""""
" Search
""""""""""""""""""""

" Disable all searchurls
jsb Object.keys(tri.config.get("searchurls")).reduce((prev, u) => prev.catch(()=>{}).then(_ => tri.excmds.setnull("searchurls." + u)), Promise.resolve())

" Add our own
set searchurls.crates https://crates.io/search?q=%s
set searchurls.flathub https://flathub.org/apps/search?q=%s
set searchurls.gh https//github.com/search?utf8=âœ“&q=%s
set searchurls.no https://search.nixos.org/options?channel=25.05&from=0&size=50&sort=relevance&type=packages&query=%s
set searchurls.nl https://noogle.dev/q?term=%s
set searchurls.nw https://wiki.nixos.org/w/index.php?search=%s
set searchurls.np https://search.nixos.org/packages?channel=25.05&from=0&size=50&sort=relevance&type=packages&query=%s
set searchurls.hm https://home-manager-options.extranix.com/?query=%s&release=release-25.05
set searchurls.mdn https://developer.mozilla.org/en-US/search?q=%s&topic=api&topic=js
set searchurls.npm https://www.npmjs.com/search?q=%s
set searchurls.maps https://www.openstreetmap.org/search?query=%s
set searchurls.protondb https://www.protondb.com/search?q=%s
set searchurls.python https://docs.python.org/3/search.html?q=%s
set searchurls.rustdoc https://doc.rust-lang.org/std/index.html?search=%s
set searchurls.searx https://search.mcgee.red/?q=%s&categories=general&language=en-US
set searchurls.steam https://store.steampowered.com/search/?term=%s
set searchurls.tmuxp https://tmuxp.git-pull.com/search.html?q=%s&check_keywords=yes&area=default#
set searchurls.w https://en.wikipedia.org/w/index.php?search=%s&title=Special%3ASearch
set searchurls.yt https://www.youtube.com/results?search_query=%s

" Set the default to not be Google
set searchengine searx

""""""""""""""""""""
" Bindings
""""""""""""""""""""

bind U undo window

" Tridactyl search
 bind / fillcmdline find
 bind ? fillcmdline find --reverse
 bind n findnext --search-from-view
 bind N findnext --search-from-view --reverse
 bind gn findselect
 bind gN composite findnext --search-from-view --reverse; findselect

" Clear annoying search highlighting
bind <Escape> composite mode normal ; hidecmdline; nohlsearch

" The default jump of 10 is a bit much.
bind j scrollline 5
bind k scrollline -5

" tabprev & tabnext are backwards for vertical tabs
bind J tabnext
bind K tabprev

" Private window
bind --mode=normal <C-P> winopen -private

" make t open the selection with tabopen
bind --mode=visual t composite js document.getSelection().toString() | fillcmdline tabopen

" Make `gi` on GitHub take you to the search box
bindurl ^https://github.com gi hint -Vc .AppHeader-searchButton
bindurl https://github.com/.*/.*/blob f hint -c .blob-num,a

bindurl youtu((\.be)|(be\.com)) f hint -J

""""""""""""""""""""
" URL Redirects
""""""""""""""""""""

""""""""""""""""""""
" Containers
""""""""""""""""""""

autocontain -s youtu((\.be)|(be\.com)) google
autocontain -s google\.com google

autocontain -s facebook\.com social
autocontain -s instagram\.com social
autocontain -s tiktok\.com social
autocontain -s x\.com social

autocontain -s aither\.cc torrents
autocontain -s iptorrents\.(com|me) torrents
autocontain -s digitalcore\.club torrents
autocontain -s torrentleech\.(org|me) torrents
autocontain -s myanonamouse\.net torrents
autocontain -s fearnopeer\.com torrents
autocontain -s qb\.mcgee\.red torrents

autocontain -s leaderscu\.com banking

" vim: set filetype=tridactyl
